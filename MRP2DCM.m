
z1 = -0.1; z2 = 0.3; z3 = 0.1;
s1= 0.1; s2 = 0.2; s3 = 0.3;
s = sqrt(s1*s1+s2*s2+s3*s3);
det = 1/(1+s*s)^2;

C11 = 4*(s1*s1-s2*s2-s3*s3)+(1-s*s)^2;
C12 = 8*s1*s2+4*s3*(1-s*s);
C13 = 8*s1*s3-4*s2*(1-s*s);
C21 = 8*s2*s1 - 4 *s3*(1-s*s);
C22 = 4*(-s1*s1+s2*s2-s3*s3)+(1-s*s)^2;
C23 = 8*s2*s3 + 4*s1*(1-s*s);
C31 = 8*s3*s1 + 4*s2*(1-s*s);
C32 = 8*s3*s2-4*s1*(1-s*s);
C33 = 4*(-s1*s1-s2*s2+s3*s3)+(1-s*s)^2;

Cmat = [C11 C12 C13; C21 C22 C23; C31 C32 C33];
C = Cmat*det

